# 자바의 신

### 예외란?

자바에는 예외는 우리가 예상한, 혹은 예상치도 못한 일이 발생 하는 것을 미리 예견하고 안전장치를 하는 것이다. <br>
자바에서는 예상을 했던 , 안했든 예외적인 일이 발생하면 "예외" 라는 것을 던져버린다. <br>
예를 들어 null 인 객체에 메소드를 호출하던지, 배열의 길이보다 긴 값을 호출하던지 등등 예외상황이 오면 에외를 던진다.

---
### try - catch

설명하기 전에 배열 밖에 있는 값을 읽으려고 할 때 오류를 확인해보자.

#### <div id = "arrayException"> ArrayException </div>
~~~java
public class ExceptionEx {
    public void arrayOutOfBounds() {
        int[] arr = new int[5];
        System.out.println(arr[5]);
    }
    public static void main(String[] args) {
        ExceptionEx ex = new ExceptionEx();
        ex.arrayOutOfBounds();
    }
}
~~~

#### 실행결과

> <span style = "color : red"> at ExceptionEx.arrayOutOfBounds(ExceptionEx.java:4) </span>

이렇게 ArrayIndexOutOfBoundsException 오류가 났는데 이것은 배열의 범위 밖에 있는 위치를 요청한 예외 라는 것이다.<br>
컴파일할 때 에러메세지가 생기는 것처럼 예외의 첫 줄에는 어떤 예외가 발생했는지 출력된다.

그렇다면 예외처리를 해서 예외 메세지를 발생시키지 않도록 해보자.

위의[코드](#arrayException)에서 해당 부분을 수정해보자.

~~~java
public void arrayOutOfBounds() {
    int[] arr = new int[5];
    try{
        System.out.println(arr[5]);
    }catch(Exception e){
        System.out.println("Error");
    }
    System.out.println("finish");
}
~~~

#### 실행결과

> Error

예외가 발생하는 부분을 try-catch 로 묶어주면 정상적으로 컴파일도 되고 실행도 정상적으로 된다.

**Q.** try 부분에서 에러가 발생되면 catch로 넘어가는 것을 확인했다. 그렇다면 try에서 오류가 없는 부분도 있다면 출력이 될까? <br>

~~~java
public void arrayOutOfBoundsTryCatch() {
    int[] arr = new int[5];
    try {
        System.out.println(arr[5]);
        System.out.println("try code");
    } catch (Exception e) {
        System.err.println("Exception");
    }
    System.out.println("finish");
}
~~~

#### 실행결과

> <span style = "color : red"> Exception </span> <br>
> finish

try문에 오류를 발견하는 즉시 catch로 넘어가 그 뒤에 있는 코드는 실행되지 않는 걸 확인할 수 있다. <br>
그리고, System.err.println 을 사용하면 글씨가 빨간색으로 나오게 된다.

#### 정리해보면

- try-catch 에서 예외가 발생하지 않은 경우
    - try 내에 있는 모든 문장이 실행되고 try-catch 문장 이후에 내용이 실행된다.
    
- try-catch 에서 예외가 발생하는 경우
    - try 내에서 예외가 발생한 이후의 문장들은 실행되지 않는다. <br>
    catch 내에 있는 문장은 반드시 실행되고, try-catch 문장 이후의 내용이 실행된다.
      
---

**Q.** catch 문에서 try 문에 선언한 변수를 사용할 수 있을까? <br>

위의[코드](#arrayException)에서 메소드를 추가해 보자.
~~~java
public void checkVariable() {
        try {
            int[] arr = new int[5];
            System.out.println(arr[5]);
        } catch (Exception e) {
            System.out.println(arr.length);
        }
        System.out.println("finish");
    }
~~~

#### 실행결과

<span style = "color : #ff0000"> java: cannot find symbol <br>
symbol:   variable arr <br>
location: class ExceptionEx <br> </span>

try 블록이랑 catch 블록이랑 다르기 때문에 오류가 났으며 오류 내용 역시 symbol 을 찾을 수 없다고 나온다. <br>
그렇기 때문에 , 일반적으로 catch 문장에서 사용할 변수 같은 경우 try 문장 밖에 선언한다.

**Q.** try 블록에 있던게 catch 블록에서 사용못하는 것처럼 try 블록 밖에 선언하면 안되는게 아닌가?? <br>
**A.** 예외가 발생하여 catch 블록이 실행된다고 하여 try 의 모든 문장이 무시되는 것이 아니라 예외를 호출하는 순간 발생한다. <br>
그렇기 때문에 그 앞에서 실행된 문장은 전혀 문제 없이 실행된다.

---
### finally

~~~java
public class FinallyEx {
  public void finallyExample() {
    int[] arr = new int[5];
    try {
      System.out.println(arr[5]);
    } catch (Exception e) {
      System.out.println(arr.length);
    }finally {
      System.out.println("finally");
    }
    System.out.println("Done");
  }
  public static void main(String[] args) {
    FinallyEx ex = new FinallyEx();
    ex.finallyExample();
  }
}
~~~

#### 실행결과

>5 <br>
finally <br>
Done

finally 블록은 예외 발생 여부와 상관없이 실행된다. try-catch 블록 이후에 코드 작성하면 되지 않나? 라는 생각이 들었지만 <br>
코드 중복을 위해 필요하다고 책의 필자는 말한다.

---
### 두 개 이상의 catch

예외 처리를 할 때 catch 블록을 한개만 쓰는 것이 아니라 두 개 이상 사용이 가능하다. <br>
**Q.** 그렇다면 예외가 겹치는 경우에는 catch 블록이 모두 실행될까?

위의[코드](#arrayException)에서 해당 메소드를 추가해보자.
~~~java
public void multiCatch() {
    int[] arr = new int[5];
    try {
        System.out.println(arr[5]);
    } catch (ArrayIndexOutOfBoundsException e) {
        System.out.println("ArrayIndexOutOfBoundsException");
    } catch (Exception e) {
        System.out.println("Exception");
    }
}
~~~

#### 실행결과

> ArrayIndexOutOfBoundsException

switch 문 case 에 break 추가한거 처럼 나가는 것 같다. 그렇다면 두 순서를 바꿔보자.

#### 실행결과

> java: exception java.lang.ArrayIndexOutOfBoundsException has already been caught

이미 해당 예외처리를 했다고 오류가 나온다. 순서만 바꿨는데 에러가 난 것이다. <br>
이 말은 즉, Exception  ArrayIndexOutOfBoundsException 에이 포함된다는 것이다. <br>
자세히 말하면 java.lang.Exception 는 모든 예외 클래스의 부모이다. <br>
ArrayIndexOutOfBoundsException 은 Exception 의 자식 클래스다.

그렇기 때문에 범위가 큰 예외는 가장 마지막 catch 블록에 위치 하는게 맞다.

#### 정리해보면

- try 다음에 오는 catch 블록은 1개 이상 가능하다.
- 먼저 선언한 catch 블록의 에외 클래스가 다음에 선언한 catch 블록의 부모면, 자식에 속한 catch 블록은 절대 실행되지 않아 컴파일 되지 않는다.
- 하나의 try 블록에서 예외가 발생하면 그 예외와 관련이 있는 catch 블록을 찾아 실행한다.

---
